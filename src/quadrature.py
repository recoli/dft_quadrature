def euler_maclaurin_quad(start,end,n_points):
    roots = [start + i*(float(end - start)/(n_points-1)) for i in range(0,n_points)]
    # roots = [start + i*float(end - start)/n_points for i in range(0,n_points+1)]
    weights = [(float(end-start)/(n_points-1))]*n_points
    weights[0] = weights[0]/2
    weights[-1] = weights[-1]/2
    return weights,roots
    
# We use our own because numpy doesnt get within 1e-14 for 7th order poly, unsure why
# Credit for roots/weights: http://pomax.github.io/bezierinfo/legendre-gauss.html
def gauss_legendre_quad(n_points):
    if n_points == 2:
        weights = [1.0,1.0]
        roots = [-0.5773502691896257,0.5773502691896257]
    elif n_points == 3:
        weights = [0.8888888888888888,0.5555555555555556,0.5555555555555556]
        roots = [0.0000000000000000,-0.7745966692414834,0.7745966692414834]
    elif n_points == 4:
        weights = [0.6521451548625461,0.65214515486254610,0.3478548451374538,0.3478548451374538]
        roots = [-0.3399810435848563,0.3399810435848563,-0.8611363115940526,0.8611363115940526]
    elif n_points == 5:
        weights = [0.5688888888888889,0.4786286704993665,0.4786286704993665,0.2369268850561891,0.2369268850561891]
        roots = [0.0000000000000000,-0.5384693101056831,0.5384693101056831,-0.9061798459386640,0.9061798459386640]
    elif n_points == 6:
        weights = [0.3607615730481386,0.3607615730481386,0.4679139345726910,0.4679139345726910,0.1713244923791704,0.1713244923791704]
        roots = [0.6612093864662645,-0.6612093864662645,-0.2386191860831969,0.2386191860831969,-0.9324695142031521,0.9324695142031521]
    elif n_points == 7:
        weights = [0.4179591836734694,0.3818300505051189,0.3818300505051189,0.2797053914892766,0.2797053914892766,0.1294849661688697,0.1294849661688697]
        roots = [0.0000000000000000,0.4058451513773972,-0.4058451513773972,-0.7415311855993945,0.7415311855993945,-0.9491079123427585,0.9491079123427585]
    elif n_points == 8:
        weights = [0.3626837833783620,0.3626837833783620,0.3137066458778873,0.3137066458778873,0.2223810344533745,0.2223810344533745,0.1012285362903763,0.1012285362903763]
        roots = [-0.1834346424956498,0.1834346424956498,-0.5255324099163290,0.5255324099163290,-0.7966664774136267,0.7966664774136267,-0.9602898564975363,0.9602898564975363]
    elif n_points == 9:
        weights = [0.3302393550012598,0.1806481606948574,0.1806481606948574,0.0812743883615744,0.0812743883615744,0.3123470770400029,0.3123470770400029,0.2606106964029354,0.2606106964029354]
        roots = [0.0000000000000000,-0.8360311073266358,0.8360311073266358,-0.9681602395076261,0.9681602395076261,-0.3242534234038089,0.3242534234038089,-0.6133714327005904,0.6133714327005904]
    elif n_points == 10:
        weights = [0.2955242247147529,0.2955242247147529,0.2692667193099963,0.2692667193099963,0.2190863625159820,0.2190863625159820,0.1494513491505806,0.1494513491505806,0.0666713443086881,0.0666713443086881]
        roots = [-0.1488743389816312,0.1488743389816312,-0.4333953941292472,0.4333953941292472,-0.6794095682990244,0.6794095682990244,-0.8650633666889845,0.8650633666889845,-0.9739065285171717,0.9739065285171717]
    elif n_points == 11:
        weights = [0.2729250867779006,0.2628045445102467,0.2628045445102467,0.2331937645919905,0.2331937645919905,0.1862902109277343,0.1862902109277343,0.1255803694649046,0.1255803694649046,0.0556685671161737,0.0556685671161737]
        roots = [0.0000000000000000,-0.2695431559523450,0.2695431559523450,-0.5190961292068118,0.5190961292068118,-0.7301520055740494,0.7301520055740494,-0.8870625997680953,0.8870625997680953,-0.9782286581460570,0.9782286581460570]
    elif n_points == 12:
        weights = [0.2491470458134028,0.2491470458134028,0.2334925365383548,0.2334925365383548,0.2031674267230659,0.2031674267230659,0.1600783285433462,0.1600783285433462,0.1069393259953184,0.1069393259953184,0.0471753363865118,0.0471753363865118]
        roots = [-0.1252334085114689,0.1252334085114689,-0.3678314989981802,0.3678314989981802,-0.5873179542866175,0.5873179542866175,-0.7699026741943047,0.7699026741943047,-0.9041172563704749,0.9041172563704749,-0.9815606342467192,0.9815606342467192]
    elif n_points == 13:
        weights = [0.2325515532308739,0.2262831802628972,0.2262831802628972,0.2078160475368885,0.2078160475368885,0.1781459807619457,0.1781459807619457,0.1388735102197872,0.1388735102197872,0.0921214998377285,0.0921214998377285,0.0404840047653159,0.0404840047653159]
        roots = [0.0000000000000000,-0.2304583159551348,0.2304583159551348,-0.4484927510364469,0.4484927510364469,-0.6423493394403402,0.6423493394403402,-0.8015780907333099,0.8015780907333099,-0.9175983992229779,0.9175983992229779,-0.9841830547185881,0.9841830547185881]
    elif n_points == 14:
        weights = [0.2152638534631578,0.2152638534631578,0.2051984637212956,0.2051984637212956,0.1855383974779378,0.1855383974779378,0.1572031671581935,0.1572031671581935,0.1215185706879032,0.1215185706879032,0.0801580871597602,0.0801580871597602,0.0351194603317519,0.0351194603317519]
        roots = [-0.1080549487073437,0.1080549487073437,-0.3191123689278897,0.3191123689278897,-0.5152486363581541,0.5152486363581541,-0.6872929048116855,0.6872929048116855,-0.8272013150697650,0.8272013150697650,-0.9284348836635735,0.9284348836635735,-0.9862838086968123,0.9862838086968123]
    elif n_points == 15:
        weights = [0.2025782419255613,0.1984314853271116,0.1984314853271116,0.1861610000155622,0.1861610000155622,0.1662692058169939,0.1662692058169939,0.1395706779261543,0.1395706779261543,0.1071592204671719,0.1071592204671719,0.0703660474881081,0.0703660474881081,0.0307532419961173,0.0307532419961173]
        roots = [0.0000000000000000,-0.2011940939974345,0.2011940939974345,-0.3941513470775634,0.3941513470775634,-0.5709721726085388,0.5709721726085388,-0.7244177313601701,0.7244177313601701,-0.8482065834104272,0.8482065834104272,-0.9372733924007060,0.9372733924007060,-0.9879925180204854,0.9879925180204854]
    elif n_points == 16:
        weights = [0.1894506104550685,0.1894506104550685,0.1826034150449236,0.1826034150449236,0.1691565193950025,0.1691565193950025,0.1495959888165767,0.1495959888165767,0.1246289712555339,0.1246289712555339,0.0951585116824928,0.0951585116824928,0.0622535239386479,0.0622535239386479,0.0271524594117541,0.0271524594117541]
        roots = [-0.0950125098376374,0.0950125098376374,-0.2816035507792589,0.2816035507792589,-0.4580167776572274,0.4580167776572274,-0.6178762444026438,0.6178762444026438,-0.7554044083550030,0.7554044083550030,-0.8656312023878318,0.8656312023878318,-0.9445750230732326,0.9445750230732326,-0.9894009349916499,0.9894009349916499]
    elif n_points == 17:
        weights = [0.1794464703562065,0.1765627053669926,0.1765627053669926,0.1680041021564500,0.1680041021564500,0.1540457610768103,0.1540457610768103,0.1351363684685255,0.1351363684685255,0.1118838471934040,0.1118838471934040,0.0850361483171792,0.0850361483171792,0.0554595293739872,0.0554595293739872,0.0241483028685479,0.0241483028685479]
        roots = [0.0000000000000000,-0.1784841814958479,0.1784841814958479,-0.3512317634538763,0.3512317634538763,-0.5126905370864769,0.5126905370864769,-0.6576711592166907,0.6576711592166907,-0.7815140038968014,0.7815140038968014,-0.8802391537269859,0.8802391537269859,-0.9506755217687678,0.9506755217687678,-0.9905754753144174,0.9905754753144174]
    elif n_points == 18:
        weights = [0.1691423829631436,0.1691423829631436,0.1642764837458327,0.1642764837458327,0.1546846751262652,0.1546846751262652,0.1406429146706507,0.1406429146706507,0.1225552067114785,0.1225552067114785,0.1009420441062872,0.1009420441062872,0.0764257302548891,0.0764257302548891,0.0497145488949698,0.0497145488949698,0.0216160135264833,0.0216160135264833]
        roots = [-0.0847750130417353,0.0847750130417353,-0.2518862256915055,0.2518862256915055,-0.4117511614628426,0.4117511614628426,-0.5597708310739475,0.5597708310739475,-0.6916870430603532,0.6916870430603532,-0.8037049589725231,0.8037049589725231,-0.8926024664975557,0.8926024664975557,-0.9558239495713977,0.9558239495713977,-0.9915651684209309,0.9915651684209309]
    elif n_points == 19:
        weights = [0.1610544498487837,0.1589688433939543,0.1589688433939543,0.1527660420658597,0.1527660420658597,0.1426067021736066,0.1426067021736066,0.1287539625393362,0.1287539625393362,0.1115666455473340,0.1115666455473340,0.0914900216224500,0.0914900216224500,0.0690445427376412,0.0690445427376412,0.0448142267656996,0.0448142267656996,0.0194617882297265,0.0194617882297265] 
        roots = [0.0000000000000000,-0.1603586456402254,0.1603586456402254,-0.3165640999636298,0.3165640999636298,-0.4645707413759609,0.4645707413759609,-0.6005453046616810,0.6005453046616810,-0.7209661773352294,0.7209661773352294,-0.8227146565371428,0.8227146565371428,-0.9031559036148179,0.9031559036148179,-0.9602081521348300,0.9602081521348300,-0.9924068438435844,0.9924068438435844]
    elif n_points == 20:
        weights = [0.1527533871307258,0.1527533871307258,0.1491729864726037,0.1491729864726037,0.1420961093183820,0.1420961093183820,0.1316886384491766,0.1316886384491766,0.1181945319615184,0.1181945319615184,0.1019301198172404,0.1019301198172404,0.0832767415767048,0.0832767415767048,0.0626720483341091,0.0626720483341091,0.0406014298003869,0.0406014298003869,0.0176140071391521,0.0176140071391521]
        roots = [-0.0765265211334973,0.0765265211334973,-0.2277858511416451,0.2277858511416451,-0.3737060887154195,0.3737060887154195,-0.5108670019508271,0.5108670019508271,-0.6360536807265150,0.6360536807265150,-0.7463319064601508,0.7463319064601508,-0.8391169718222188,0.8391169718222188,-0.9122344282513259,0.9122344282513259,-0.9639719272779138,0.9639719272779138,-0.9931285991850949,0.9931285991850949]
    else:
        raise ValueError("Unsupported number of points")
    return weights,roots